# Детекция логотипа Т-Банка

## Описание
Решение для задачи автоматического поиска и детекции логотипа **Т-Банка** на изображениях.  
Логотип: стилизованная буква **"Т"** внутри щита (цвет может быть разным).  
API реализовано на **FastAPI**, детекция — с помощью модели **YOLO12s**, обученной на собственном датасете (YOLO format).

## Структура проекта
tlogo_fastapi_yolo/  
├── app/  
│ └── main.py                              # Точка входа, запуск FastAPI-приложения  
├── models/  
│ └── best.pt                              # Обученная модель YOLOv12  
├── validation_data/                       # Папка с валидационными данными  
├── docker-compose.yml                     # Конфигурация для запуска API в Docker Compose  
├── Dockerfile                             # Сборка Docker-образа API  
├── requirements.txt                       # Зависимости Python  
├── tlogo_preparation_for_annotation.ipynb # Ноутбук для подготовки/разметки данных  
└── tlogo_training.ipynb                   # Ноутбук обучения модели  
## API контракт
Эндпоинт `/detect` принимает изображение (JPEG, PNG, BMP, WEBP) и возвращает список найденных логотипов.

```python
class BoundingBox(BaseModel):
    x_min: int
    y_min: int
    x_max: int
    y_max: int

class Detection(BaseModel):
    bbox: BoundingBox

class DetectionResponse(BaseModel):
    detections: List[Detection]
```
## Пример ответа
```
{
  "detections": [
    {
      "bbox": {"x_min": 120, "y_min": 85, "x_max": 260, "y_max": 230}
    }
  ]
}
```
## Запуск
•	Создать пустую папку на ПК  
•	Убедиться, что установлен Docker / установить  
•   Склонировать репозиторий:  
    git clone https://github.com/<your_name>/Fastapi_YOLO.git  
    cd Fastapi_YOLO  
•   Собрать и запустить контейнер:  
    docker compose up --build -d  
•	Обращаться к localhost:8000  



# Проделанные шаги

## Первоначальная разметка набора данных
Полученнный датасет содержит 30079 изображений, ручная разметка такого набора данных силами одного человека (в адекватные сроки) невозможна, поэтому воспользуемся zero-shot подходом для первоначальной разметки изображений. Поскольку zero-shot моделей для задач object detection много, воспользуемся информацией со страницы https://huggingface.co/models?pipeline_tag=zero-shot-object-detection и возьмем самые популярные архитектуры. В первую очередь обращаем внимание на модели, обновлявшиеся в 2024-2025 году, тут на выбор есть 2 основные архитектуры — OWLiT(OWLv2), Grounding DINO.

Каким образом будет происходить оценка работ всех этих моделей? На портале Roboflow уже находится некоторое количество размеченных изображений (https://universe.roboflow.com/jull-7hwfj/1200-8o5s6), выполнив ручную проверку данного набора убеждаемся, что разметка была проведена верно. Составленный набор содержит большое количество логотипов Т-банка разных цветов, размеров, снятых с разных углов. В нем имеется достаточное количество изображений логотипа банка "Тинькофф", которые следует избегать по условию кейса. Также в набор собственноручно было добавлено некоторое количество изображений, никак не относящихся к "Т-банку", что будет являться хорошей проверкой на False Positive срабатывания.

Имея опыт работы с задачей детекции используя фреймворк Ultralytics и модели YOLO — я проверил как показывает себя модель YOLOv8x-worldv2, однако она показала результаты Precision и Recall ниже 0.1. Поскольку YOLO-world это open-vocabulary детектор, он плохо справляется с обнаружением изображений по длинным фразам, оставим его до лучших времен. Будем проводить эксперименты с OWLv2 и Grounding DINO.


